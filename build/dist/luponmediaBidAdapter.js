pbjsChunk([222],{593:function(e,r,t){e.exports=t(594)},594:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),t.d(r,"spec",function(){return o}),r.hasValidSupplyChainParams=x,r.resetUserSync=function(){u=!1};var y=t(0),i=t(1),g=t(3),n=t(2),s=t(4);function m(){return(m=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)}function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function I(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var t=[],i=!0,n=!1,s=void 0;try{for(var a,o=e[Symbol.iterator]();!(i=(a=o.next()).done)&&(t.push(a.value),!r||t.length!==r);i=!0);}catch(e){n=!0,s=e}finally{try{i||null==o.return||o.return()}finally{if(n)throw s}}return t}(e,r)||function(e,r){if(!e)return;if("string"==typeof e)return a(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return a(e,r)}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,i=new Array(r);t<r;t++)i[t]=e[t];return i}var S={PREBID_SERVER:{id:"id",keyv:"keyv"}},o={code:"luponmedia",supportedMediaTypes:[n.b],isBidRequestValid:function(e){return!!(e.params&&e.params.siteId&&e.params.keyId)},buildRequests:function(e,r){for(var t={method:"POST",url:"https://rtb.adxpremium.services/openrtb2/auction",data:null,options:{},bidderRequest:r},i=[],n=0,s=e.length;n<s;n++){var a=function(e,r,t){e.startTime=(new Date).getTime();var i=y.deepAccess(e,"mediaTypes.banner"),n=[];{var s;i&&i.sizes&&(s=y.parseSizesInput(i.sizes).map(function(e){var r=I(e.split("x"),2),t=r[0],i=r[1];return{w:parseInt(t,10),h:parseInt(i,10)}}),n=s)}var a={id:e.transactionId,test:g.b.getConfig("debug")?1:0,source:{tid:e.transactionId},tmax:g.b.getConfig("timeout")||1500,imp:t.concat([{id:e.bidId,secure:1,ext:h({},e.bidder,e.params),banner:{format:n}}]),ext:{prebid:{targeting:{includewinners:!0,includebidderkeys:!1}}},user:{}},o=parseFloat(y.deepAccess(e,"params.floor"));isNaN(o)||(a.imp[0].bidfloor=o);!function(e,r,t){if(!e)return;"object"===v(g.b.getConfig("app"))?e.app=g.b.getConfig("app"):e.site={page:function(e,r){var t=g.b.getConfig("pageUrl");t=e.params.referrer?e.params.referrer:t||r.refererInfo.referer;return e.params.secure?t.replace(/^http:/i,"https:"):t}(r,t)};"object"===v(g.b.getConfig("device"))&&(e.device=g.b.getConfig("device"))}(a,e,r);var u,d=function(){var e,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=1<arguments.length?arguments[1]:void 0;if(!r||!S[r])return null;var i=S[r];var n=function(){var e=y.deepAccess(t,"userId.digitrustid.data");if(e)return e;var r=window.DigiTrust&&(g.b.getConfig("digiTrustId")||window.DigiTrust.getUser({member:"T9QSFKPDN9"}));return r&&r.success&&r.identity||null}();if(!n||n.privacy&&n.privacy.optout)return null;var s=(h(e={},i.id,n.id),h(e,i.keyv,n.keyv),e);i.pref&&(s[i.pref]=0);return s}(e,"PREBID_SERVER");d&&y.deepSetValue(a,"user.ext.digitrust",d);r.gdprConsent&&("boolean"==typeof r.gdprConsent.gdprApplies&&(u=r.gdprConsent.gdprApplies?1:0),y.deepSetValue(a,"regs.ext.gdpr",u),y.deepSetValue(a,"user.ext.consent",r.gdprConsent.consentString));r.uspConsent&&y.deepSetValue(a,"regs.ext.us_privacy",r.uspConsent);y.deepSetValue(a,"user.id",y.generateUUID()),e.crumbs&&e.crumbs.pubcid?y.deepSetValue(a,"user.buyeruid",e.crumbs.pubcid):y.deepSetValue(a,"user.buyeruid",y.generateUUID());e.userId&&"object"===v(e.userId)&&(e.userId.tdid||e.userId.pubcid||e.userId.lipb||e.userId.idl_env)&&(y.deepSetValue(a,"user.ext.eids",[]),e.userId.tdid&&a.user.ext.eids.push({source:"adserver.org",uids:[{id:e.userId.tdid,ext:{rtiPartner:"TDID"}}]}),e.userId.pubcid&&a.user.ext.eids.push({source:"pubcommon",uids:[{id:e.userId.pubcid}]}),e.userId.lipb&&e.userId.lipb.lipbid&&(a.user.ext.eids.push({source:"liveintent.com",uids:[{id:e.userId.lipb.lipbid}]}),a.user.ext.tpid={source:"liveintent.com",uid:e.userId.lipb.lipbid},Array.isArray(e.userId.lipb.segments)&&e.userId.lipb.segments.length&&y.deepSetValue(a,"rp.target.LIseg",e.userId.lipb.segments)),e.userId.idl_env&&a.user.ext.eids.push({source:"liveramp.com",uids:[{id:e.userId.idl_env}]}));!0===g.b.getConfig("coppa")&&y.deepSetValue(a,"regs.coppa",1);e.schain&&x(e.schain)&&y.deepSetValue(a,"source.ext.schain",e.schain);var p=g.b.getLegacyFpd(g.b.getConfig("ortb2"))||{},c=m({},e.params.inventory,p.context),l=m({},e.params.visitor,p.user);{var f;y.isEmpty(c)&&y.isEmpty(l)||(f={bidders:[r.bidderCode],config:{fpd:{}}},y.isEmpty(c)||(f.config.fpd.site=c),y.isEmpty(l)||(f.config.fpd.user=l),y.deepSetValue(a,"ext.prebid.bidderconfig.0",f))}var b=y.deepAccess(e,"ortb2Imp.ext.data.pbadslot");"string"==typeof b&&b&&y.deepSetValue(a.imp[0].ext,"context.data.adslot",b);return a}(e[n],r,i),i=a.imp;t.data=JSON.stringify(a)}return t},interpretResponse:function(e,r){var t=[],i="USD",n=JSON.parse(r.data),s=n.site&&n.site.ref?n.site.ref:"";try{e.body&&e.body.seatbid&&y.isArray(e.body.seatbid)&&(i=e.body.cur||i,e.body.seatbid.forEach(function(e){e.bid&&y.isArray(e.bid)&&e.bid.forEach(function(e){var r={requestId:e.impid,cpm:(parseFloat(e.price)||0).toFixed(2),width:e.w,height:e.h,creativeId:e.crid||e.id,dealId:e.dealid,currency:i,netRevenue:!1,ttl:300,referrer:s,ad:e.adm};t.push(r)})}))}catch(e){y.logError(e)}return t},getUserSyncs:function(a,e){var o=[];return u||!a.iframeEnabled&&!a.pixelEnabled?y.logWarn("Luponmedia: Please enable iframe/pixel based user sync."):e.forEach(function(e){if(e.body&&e.body.ext&&e.body.ext.usersyncs)try{var r=e.body.ext.usersyncs.bidder_status;for(var t in r){var i,n,s=r[t];s.no_cookie&&(i=s.usersync.url,n=s.usersync.type,i?"image"!==n&&"redirect"!==n||!a.pixelEnabled?"iframe"==n&&a.iframeEnabled?(y.logMessage("Invoking iframe user sync for luponmedia"),o.push({type:"iframe",url:i})):y.logError('User sync type "'.concat(n,'" not supported for luponmedia')):(y.logMessage("Invoking image pixel user sync for luponmedia"),o.push({type:"image",url:i})):y.logError("No sync url for bidder luponmedia."))}}catch(e){y.logError(e)}}),u=!0,o},onBidWon:function(e){var r=JSON.stringify(e);o.sendWinningsToServer(r)},sendWinningsToServer:function(e){var r='mutation {createWin(input: {win: {eventData: "'.concat(window.btoa(e),'"}}) {win {createTime } } }'),t=JSON.stringify({query:r});Object(s.a)("https://analytics.adxpremium.services/graphql",null,t,{contentType:"application/json",method:"POST"})}};function x(e){var r=!1,t=["asi","sid","hp"];return e.nodes&&((r=e.nodes.reduce(function(e,r){return e?t.every(function(e){return r[e]}):e},!0))||y.logError("LuponMedia: required schain params missing")),r}var u=!1;Object(i.registerBidder)(o)}},[593]);