pbjsChunk([133],{812:function(r,e,n){r.exports=n(813)},813:function(r,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"sharedIdSubmodule",function(){return m});var u=n(0),s=n(4),t=n(11),o="https://id.sharedid.org/id",d=86400,i="0123456789ABCDEFGHJKMNPQRSTVWXYZ",a=i.length,c=Math.pow(2,48)-1,f=function(e){e=e||function(r){r=r||("undefined"!=typeof window?window:null);var e=r&&(r.crypto||r.msCrypto);if(e)return function(){var r=new Uint8Array(1);return e.getRandomValues(r),r[0]/255};return function(){return Math.random()}}();return function(r){return isNaN(r)&&(r=Date.now()),function(r,e){if(isNaN(r))throw new Error(r+" must be a number");if(!1===Number.isInteger(r))throw g("time must be an integer");if(c<r)throw g("cannot encode time greater than "+c);if(r<0)throw g("time must be positive");if(!1===Number.isInteger(e))throw g("length must be an integer");if(e<0)throw g("length must be positive");for(var n,t="";0<e;e--)n=r%a,t=i.charAt(n)+t,r=(r-n)/a;return t}(r,10)+function(r,e){for(var n="";0<r;r--)n=function(r){var e=Math.floor(r()*a);e===a&&(e=a-1);return i.charAt(e)}(e)+n;return n}(16,e)}}();function h(r,e){var n={};return n.id=r,n.ts=u.timestamp(),e&&(n.ns=!0),u.logInfo("SharedId: cookie Value: "+JSON.stringify(n)),n}function l(r,e){if(e.ns)return!0;r&&"number"==typeof r.syncTime||u.logInfo("SharedId: Sync time is not configured or is not a number");var n=r&&"number"==typeof r.syncTime?r.syncTime:d;d<n&&(n=d);var t,o,i=e.ts;return!!i&&n<=(t=u.timestamp(),o=(t-i)/1e3,Math.abs(Math.round(o)))}function g(r){u.logError(r);var e=new Error(r);return e.source="sharedId",e}function I(r){return r&&"boolean"==typeof r.gdprApplies&&r.gdprApplies?"".concat(o,"?gdpr=1&gdpr_consent=").concat(r.consentString):o}var m={name:"sharedId",gvlid:887,decode:function(r){return r?function(r){var e={},n=r&&"string"==typeof r.id?r.id:void 0;if("00000000000000000000000000"!=n){if(n){var t={id:n};return null==(r&&"boolean"==typeof r.ns?r.ns:void 0)&&(t.third=n),e.sharedid=t,u.logInfo("SharedId: Decoded value "+JSON.stringify(e)),e}return n}}(r):void 0},getId:function(r,e){return{callback:function(r){var t;u.logInfo("SharedId: Sharedid doesnt exists, new cookie creation"),Object(s.a)(I(e),(t=r,{success:function(r){var e={};if(r)try{var n=JSON.parse(r);u.logInfo("SharedId: Generated SharedId: "+n.sharedId),e=h(n.sharedId,!1)}catch(r){u.logError(r)}t(e)},error:function(){var r=h(f(),!0);u.logInfo("SharedId: Ulid Generated SharedId: "+r.id),t(r)}}),void 0,{method:"GET",withCredentials:!0})}}},extendId:function(r,i,d){var a=r&&r.params||{};u.logInfo("SharedId: Existing shared id "+d.id);return{callback:function(r){var e,n,t,o;l(a,d)&&(u.logInfo("SharedId: Existing shared id "+d+" is not synced"),(e={}).sharedId=d.id,n=JSON.stringify(e),Object(s.a)(I(i),(t=d,o=r,{success:function(r){if(u.logInfo("SharedId: id to be synced: "+t.id),r)try{var e=JSON.parse(r);t=h(e.sharedId,!1),u.logInfo("SharedId: Older SharedId: "+t.id)}catch(r){u.logError(r)}o(t)},error:function(){u.logInfo("SharedId: Sync error for id : "+t.id),o(t)}}),n,{method:"POST",withCredentials:!0}))}}}};Object(t.e)("userId",m)}},[812]);